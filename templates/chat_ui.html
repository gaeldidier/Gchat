<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chat UI</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5617793567158220"
     crossorigin="anonymous"></script>
  <style>
    :root{
      --bg: #0f1320;
      --card: #101b2b;
      --bubble-me: #2d6cdf;
      --bubble-you: #1f2a44;
      --text: #e8eefc;
      --muted: #aab6d6;
    }
    *{box-sizing:border-box}
    body, html { height:100%; margin:0; font-family: system-ui, -apple-system, "Segoe UI"; background:var(--bg); color:var(--text); }
    .chat {
      display:flex; flex-direction:column; height:100%; max-width:900px; margin:0 auto; border:1px solid #1e2a45; border-radius:12px; overflow:hidden;
    }
    .header { padding:12px 16px; background:#0b1220; border-bottom:1px solid #1e2a45; }
    .title { font-weight:600; }
    .messages { flex:1; padding:16px; overflow:auto; background: #0c1422; }
  .message { display:flex; gap:10px; margin:14px 0; align-items:flex-end; }
  .avatar { width:36px; height:36px; border-radius:50%; object-fit:cover; background:#6b7bd6; }
  .bubble { padding:10px 16px; border-radius:18px; max-width:65%; line-height:1.5; position:relative; font-size:1rem; }
  .me { flex-direction:row-reverse; justify-content:flex-end; }
  .me .bubble { background: var(--bubble-me); color:white; border-bottom-right-radius:6px; margin-left:8px; }
  .you { flex-direction:row; justify-content:flex-start; }
  .you .bubble { background: var(--bubble-you); color:white; border-bottom-left-radius:6px; margin-right:8px; }
  .timestamp { font-size:11px; color:var(--muted); margin-top:2px; margin-left:4px; margin-right:4px; }
  .read-receipt { font-size:13px; margin-left:6px; color: #6b7bd6; vertical-align:middle; }
    .composer { display:flex; padding:12px; border-top:1px solid #1e2a45; background:#0f1626; }
    .input { flex:1; padding:12px; border-radius:20px; border:1px solid #334466; outline:none; background:#0b1220; color:var(--text); }
    .send { margin-left:8px; padding:0 14px; border-radius:20px; border:1px solid #2b5bd9; background:#2b5bd9; color:white; cursor:pointer; }
  </style>
</head>
<body>
  <div class="chat" id="chat">
    <div class="header">
      <span class="title">Chat Room</span>
      <span style="float:right; color:var(--muted); font-size:12px;">Online â€¢ End-to-end encrypted</span>
    </div>
    <div class="messages" id="messages"></div>
    <div class="composer">
      <input id="text" class="input" placeholder="Type your message..." />
      <button class="send" id="send">Send</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.6.1/socket.io.min.js"></script>
  <script>
    // Pass server-side variables to JS for chat.js
    window.friendId = friend.id;
  window.userName = {{ user.username|tojson }};
  </script>
  <script src="/static/chat.js"></script>
</body>
</html>