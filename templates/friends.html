<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Friends</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h2>Friends</h2>
    <h4>Accepted Friends</h4>
    <ul>
        {% for f in accepted %}
            <li>
                {{ f.friend.username if f.friend_id != user.id else f.user.username }}
                <a href="/chat/{{ f.friend_id if f.friend_id != user.id else f.user_id }}" class="btn btn-sm btn-primary ms-2">Chat</a>
                <form method="post" style="display:inline;">
                    <input type="hidden" name="user_id" value="{{ f.friend_id if f.friend_id != user.id else f.user_id }}">
                    <input type="hidden" name="action" value="remove">
                    <button class="btn btn-sm btn-danger">Remove</button>
                </form>
            </li>
        {% else %}
            <li>No friends yet.</li>
        {% endfor %}
    </ul>
    <h4>Pending Requests Sent</h4>
    <ul>
        {% for f in pending %}
            <li>{{ f.friend.username }} (pending)
                <form method="post" style="display:inline;">
                    <input type="hidden" name="user_id" value="{{ f.friend_id }}">
                    <input type="hidden" name="action" value="remove">
                    <button class="btn btn-sm btn-danger">Cancel</button>
                </form>
            </li>
        {% else %}
            <li>No pending requests.</li>
        {% endfor %}
    </ul>
    <h4>Requests Received</h4>
    <ul>
        {% for f in received %}
            <li>{{ f.user.username }}
                <form method="post" style="display:inline;">
                    <input type="hidden" name="user_id" value="{{ f.user_id }}">
                    <input type="hidden" name="action" value="accept">
                    <button class="btn btn-sm btn-success">Accept</button>
                </form>
            </li>
        {% else %}
            <li>No requests received.</li>
        {% endfor %}
    </ul>
    <h4>Add Friends</h4>
    <ul>
        {% for u in others %}
            <li>{{ u.username }}
                <form method="post" style="display:inline;">
                    <input type="hidden" name="user_id" value="{{ u.id }}">
                    <input type="hidden" name="action" value="add">
                    <button class="btn btn-sm btn-primary">Add Friend</button>
                </form>
            </li>
        {% else %}
            <li>No users to add.</li>
        {% endfor %}
    </ul>
    <a href="/" class="btn btn-secondary mt-3">Back to Home</a>
</div>
</body>
</html>
